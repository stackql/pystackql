# Error patterns for centralized error detection in PyStackQL
#
# This file defines patterns that should be detected as errors when they appear
# in query results. These patterns are checked against messages returned in stdout
# to identify error conditions that would otherwise be treated as valid data.
#
# Pattern Types:
# - fuzzy_matches: Substring matching (case-insensitive)
# - exact_matches: Exact string matching (case-sensitive)
# - regex_matches: Regular expression matching (for complex patterns with variable parts)

errors:
  # Fuzzy matches - will match if the pattern appears anywhere in the message
  fuzzy_matches:
    # HTTP error status codes (4xx client errors, 5xx server errors)
    - "http response status code: 4"
    - "http response status code: 5"

    # StackQL-specific error patterns from stackql-deploy
    - "disparity in fields"
    - "cannot find matching operation"

    # Additional StackQL error patterns
    - "invalid query"
    - "syntax error"

  # Exact matches - must match the entire message or start with this prefix
  exact_matches:
    - "error:"
    - "ERROR:"
    - "Error:"
    - "FAILED"
    - "FAILURE"

  # Regex matches - regular expressions for complex error patterns
  # Use standard Python regex syntax (case-insensitive by default)
  regex_matches:
    # Network/DNS errors
    - 'dial tcp:.*no such host'
    - 'Get ".*".*dial tcp.*lookup.*no such host'

    # Connection errors
    - 'dial tcp.*connection refused'
    - 'unable to connect to.*connection refused'

    # Timeout errors
    - 'context deadline exceeded'
    - 'timeout.*waiting for'

    # Generic network errors
    - 'dial tcp.*i/o timeout'
    - 'net/http.*timeout'
